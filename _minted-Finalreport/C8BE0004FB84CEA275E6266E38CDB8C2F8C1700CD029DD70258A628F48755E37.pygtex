\begin{Verbatim}[commandchars=\\\{\}]
\PYG{k}{function}\PYG{+w}{  }[Xdot] \PYG{p}{=}\PYG{+w}{ }\PYG{n+nf}{f3}\PYG{p}{(}t, X\PYG{p}{)}
\PYG{n}{mu} \PYG{p}{=} \PYG{l+m+mf}{5.686e\PYGZhy{}3}\PYG{p}{;} \PYG{n}{mu0} \PYG{p}{=} \PYG{l+m+mi}{4} \PYG{o}{*} \PYG{n+nb}{pi} \PYG{o}{*} \PYG{l+m+mi}{10} \PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{7}\PYG{p}{);}
\PYG{n}{N} \PYG{p}{=} \PYG{l+m+mi}{135}\PYG{p}{;} \PYG{n}{I} \PYG{p}{=} \PYG{l+m+mi}{10}\PYG{p}{;} \PYG{n}{A} \PYG{p}{=} \PYG{l+m+mf}{0.05} \PYGZca{} \PYG{l+m+mi}{2}\PYG{p}{;} \PYG{n}{m} \PYG{p}{=} \PYG{l+m+mi}{3500} \PYG{p}{;}
\PYG{n}{x} \PYG{p}{=} \PYG{n}{X}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{);} \PYG{n}{y} \PYG{p}{=} \PYG{n}{X}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{);} \PYG{n}{vx} \PYG{p}{=} \PYG{n}{X}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{);} \PYG{n}{vy} \PYG{p}{=} \PYG{n}{X}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{);}
\PYG{n}{Fmag} \PYG{p}{=} \PYG{p}{(}\PYG{n}{mu} \PYG{o}{*} \PYG{n}{N} \PYG{o}{*} \PYG{n}{I}\PYG{p}{)} \PYGZca{}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{A} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{mu0} \PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{norm}\PYG{p}{(}\PYG{n}{X}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{))} \PYG{o}{+} \PYG{l+m+mf}{0.4823}\PYG{p}{)} \PYGZca{} \PYG{l+m+mi}{2} \PYG{p}{);}
\PYG{n}{Xdot} \PYG{p}{=} \PYG{p}{[}\PYG{n}{vx}\PYG{p}{;} \PYG{n}{vy}\PYG{p}{;}  \PYG{l+m+mf}{0.001} \PYG{o}{*} \PYG{n}{Fmag} \PYG{o}{/} \PYG{n}{m}\PYG{p}{;} \PYG{l+m+mi}{0}\PYG{p}{];}
\PYG{k}{end}
\end{Verbatim}
